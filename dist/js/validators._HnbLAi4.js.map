{"version":3,"file":"validators._HnbLAi4.js","sources":["../../src/utils/validators.ts"],"sourcesContent":["/**\r\n * 驗證工具函數\r\n * 提供股票代碼、金額、日期、持股數的驗證功能\r\n * \r\n * @module validators\r\n */\r\n\r\n/**\r\n * 驗證結果介面\r\n */\r\nexport interface ValidationResult {\r\n  valid: boolean;\r\n  error?: string;\r\n}\r\n\r\n/**\r\n * 驗證股票代碼\r\n * 台股代碼規則：\r\n * - 4 位數字（上市、上櫃）\r\n * - 5 位數字（興櫃）\r\n * - 6 位數字（部分 ETF）\r\n * \r\n * @param code - 股票代碼\r\n * @returns 驗證結果\r\n * \r\n * @example\r\n * validateStockCode('2330') // { valid: true }\r\n * validateStockCode('00878') // { valid: true }\r\n * validateStockCode('ABC') // { valid: false, error: '股票代碼格式錯誤' }\r\n */\r\nexport function validateStockCode(code: string): ValidationResult {\r\n  if (!code || typeof code !== 'string') {\r\n    return {\r\n      valid: false,\r\n      error: '股票代碼不能為空'\r\n    };\r\n  }\r\n  \r\n  const trimmedCode = code.trim();\r\n  \r\n  if (trimmedCode.length === 0) {\r\n    return {\r\n      valid: false,\r\n      error: '股票代碼不能為空'\r\n    };\r\n  }\r\n  \r\n  // 台股代碼：4-6 位數字或字母數字組合\r\n  const codePattern = /^[A-Za-z0-9]{4,6}$/;\r\n  \r\n  if (!codePattern.test(trimmedCode)) {\r\n    return {\r\n      valid: false,\r\n      error: '股票代碼格式錯誤（應為 4-6 位英數字）'\r\n    };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * 驗證金額\r\n * 規則：\r\n * - 必須為數字\r\n * - 必須大於 0\r\n * - 不能為 NaN 或 Infinity\r\n * \r\n * @param amount - 金額\r\n * @param allowZero - 是否允許為 0，預設為 false\r\n * @returns 驗證結果\r\n * \r\n * @example\r\n * validateAmount(100) // { valid: true }\r\n * validateAmount(0) // { valid: false, error: '金額必須大於 0' }\r\n * validateAmount(0, true) // { valid: true }\r\n * validateAmount(-50) // { valid: false, error: '金額必須大於 0' }\r\n */\r\nexport function validateAmount(amount: number, allowZero: boolean = false): ValidationResult {\r\n  if (typeof amount !== 'number') {\r\n    return {\r\n      valid: false,\r\n      error: '金額必須為數字'\r\n    };\r\n  }\r\n  \r\n  if (isNaN(amount)) {\r\n    return {\r\n      valid: false,\r\n      error: '金額格式錯誤'\r\n    };\r\n  }\r\n  \r\n  if (!isFinite(amount)) {\r\n    return {\r\n      valid: false,\r\n      error: '金額超出範圍'\r\n    };\r\n  }\r\n  \r\n  if (allowZero) {\r\n    if (amount < 0) {\r\n      return {\r\n        valid: false,\r\n        error: '金額不能為負數'\r\n      };\r\n    }\r\n  } else {\r\n    if (amount <= 0) {\r\n      return {\r\n        valid: false,\r\n        error: '金額必須大於 0'\r\n      };\r\n    }\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * 驗證日期\r\n * 規則：\r\n * - 必須為有效的日期格式\r\n * - 可選：不能為未來日期\r\n * - 可選：必須在指定範圍內\r\n * \r\n * @param date - 日期（Date 物件、ISO 字串或時間戳記）\r\n * @param options - 驗證選項\r\n * @returns 驗證結果\r\n * \r\n * @example\r\n * validateDate('2024-01-15') // { valid: true }\r\n * validateDate('invalid') // { valid: false, error: '日期格式錯誤' }\r\n * validateDate('2025-12-31', { allowFuture: false }) // { valid: false, error: '日期不能為未來日期' }\r\n */\r\nexport function validateDate(\r\n  date: Date | string | number,\r\n  options: {\r\n    allowFuture?: boolean;\r\n    minDate?: Date;\r\n    maxDate?: Date;\r\n  } = {}\r\n): ValidationResult {\r\n  const { allowFuture = true, minDate, maxDate } = options;\r\n  \r\n  let dateObj: Date;\r\n  \r\n  if (date instanceof Date) {\r\n    dateObj = date;\r\n  } else if (typeof date === 'string') {\r\n    if (!date.trim()) {\r\n      return {\r\n        valid: false,\r\n        error: '日期不能為空'\r\n      };\r\n    }\r\n    dateObj = new Date(date);\r\n  } else if (typeof date === 'number') {\r\n    dateObj = new Date(date);\r\n  } else {\r\n    return {\r\n      valid: false,\r\n      error: '日期格式錯誤'\r\n    };\r\n  }\r\n  \r\n  if (isNaN(dateObj.getTime())) {\r\n    return {\r\n      valid: false,\r\n      error: '日期格式錯誤'\r\n    };\r\n  }\r\n  \r\n  const now = new Date();\r\n  \r\n  if (!allowFuture && dateObj > now) {\r\n    return {\r\n      valid: false,\r\n      error: '日期不能為未來日期'\r\n    };\r\n  }\r\n  \r\n  if (minDate && dateObj < minDate) {\r\n    return {\r\n      valid: false,\r\n      error: '日期早於允許的最小日期'\r\n    };\r\n  }\r\n  \r\n  if (maxDate && dateObj > maxDate) {\r\n    return {\r\n      valid: false,\r\n      error: '日期晚於允許的最大日期'\r\n    };\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n\r\n/**\r\n * 驗證持股數\r\n * 規則：\r\n * - 必須為整數\r\n * - 必須大於 0\r\n * - 台股通常以 1000 股為一張，但零股交易可以是任意正整數\r\n * \r\n * @param shares - 持股數\r\n * @param options - 驗證選項\r\n * @returns 驗證結果\r\n * \r\n * @example\r\n * validateShares(1000) // { valid: true }\r\n * validateShares(100) // { valid: true }\r\n * validateShares(0) // { valid: false, error: '持股數必須大於 0' }\r\n * validateShares(1.5) // { valid: false, error: '持股數必須為整數' }\r\n */\r\nexport function validateShares(\r\n  shares: number,\r\n  options: {\r\n    allowZero?: boolean;\r\n    requireInteger?: boolean;\r\n  } = {}\r\n): ValidationResult {\r\n  const { allowZero = false, requireInteger = true } = options;\r\n  \r\n  if (typeof shares !== 'number') {\r\n    return {\r\n      valid: false,\r\n      error: '持股數必須為數字'\r\n    };\r\n  }\r\n  \r\n  if (isNaN(shares)) {\r\n    return {\r\n      valid: false,\r\n      error: '持股數格式錯誤'\r\n    };\r\n  }\r\n  \r\n  if (!isFinite(shares)) {\r\n    return {\r\n      valid: false,\r\n      error: '持股數超出範圍'\r\n    };\r\n  }\r\n  \r\n  if (requireInteger && !Number.isInteger(shares)) {\r\n    return {\r\n      valid: false,\r\n      error: '持股數必須為整數'\r\n    };\r\n  }\r\n  \r\n  if (allowZero) {\r\n    if (shares < 0) {\r\n      return {\r\n        valid: false,\r\n        error: '持股數不能為負數'\r\n      };\r\n    }\r\n  } else {\r\n    if (shares <= 0) {\r\n      return {\r\n        valid: false,\r\n        error: '持股數必須大於 0'\r\n      };\r\n    }\r\n  }\r\n  \r\n  return { valid: true };\r\n}\r\n"],"names":["validateStockCode","code","trimmedCode","validateAmount","amount","allowZero","validateDate","date","options","allowFuture","minDate","maxDate","dateObj","validateShares","shares","requireInteger"],"mappings":"AA8BO,SAASA,EAAkBC,EAAgC,CAChE,GAAI,CAACA,GAAQ,OAAOA,GAAS,SAC3B,MAAO,CACL,MAAO,GACP,MAAO,UAAA,EAIX,MAAMC,EAAcD,EAAK,KAAA,EAEzB,OAAIC,EAAY,SAAW,EAClB,CACL,MAAO,GACP,MAAO,UAAA,EAKS,qBAEH,KAAKA,CAAW,EAO1B,CAAE,MAAO,EAAA,EANP,CACL,MAAO,GACP,MAAO,uBAAA,CAKb,CAmBO,SAASC,EAAeC,EAAgBC,EAAqB,GAAyB,CAC3F,GAAI,OAAOD,GAAW,SACpB,MAAO,CACL,MAAO,GACP,MAAO,SAAA,EAIX,GAAI,MAAMA,CAAM,EACd,MAAO,CACL,MAAO,GACP,MAAO,QAAA,EAIX,GAAI,CAAC,SAASA,CAAM,EAClB,MAAO,CACL,MAAO,GACP,MAAO,QAAA,EAIX,GAAIC,GACF,GAAID,EAAS,EACX,MAAO,CACL,MAAO,GACP,MAAO,SAAA,UAIPA,GAAU,EACZ,MAAO,CACL,MAAO,GACP,MAAO,UAAA,EAKb,MAAO,CAAE,MAAO,EAAA,CAClB,CAkBO,SAASE,EACdC,EACAC,EAII,GACc,CAClB,KAAM,CAAE,YAAAC,EAAc,GAAM,QAAAC,EAAS,QAAAC,GAAYH,EAEjD,IAAII,EAEJ,GAAIL,aAAgB,KAClBK,EAAUL,UACD,OAAOA,GAAS,SAAU,CACnC,GAAI,CAACA,EAAK,OACR,MAAO,CACL,MAAO,GACP,MAAO,QAAA,EAGXK,EAAU,IAAI,KAAKL,CAAI,CACzB,SAAW,OAAOA,GAAS,SACzBK,EAAU,IAAI,KAAKL,CAAI,MAEvB,OAAO,CACL,MAAO,GACP,MAAO,QAAA,EAIX,OAAI,MAAMK,EAAQ,QAAA,CAAS,EAClB,CACL,MAAO,GACP,MAAO,QAAA,EAMP,CAACH,GAAeG,MAFJ,KAGP,CACL,MAAO,GACP,MAAO,WAAA,EAIPF,GAAWE,EAAUF,EAChB,CACL,MAAO,GACP,MAAO,aAAA,EAIPC,GAAWC,EAAUD,EAChB,CACL,MAAO,GACP,MAAO,aAAA,EAIJ,CAAE,MAAO,EAAA,CAClB,CAmBO,SAASE,EACdC,EACAN,EAGI,GACc,CAClB,KAAM,CAAE,UAAAH,EAAY,GAAO,eAAAU,EAAiB,IAASP,EAErD,GAAI,OAAOM,GAAW,SACpB,MAAO,CACL,MAAO,GACP,MAAO,UAAA,EAIX,GAAI,MAAMA,CAAM,EACd,MAAO,CACL,MAAO,GACP,MAAO,SAAA,EAIX,GAAI,CAAC,SAASA,CAAM,EAClB,MAAO,CACL,MAAO,GACP,MAAO,SAAA,EAIX,GAAIC,GAAkB,CAAC,OAAO,UAAUD,CAAM,EAC5C,MAAO,CACL,MAAO,GACP,MAAO,UAAA,EAIX,GAAIT,GACF,GAAIS,EAAS,EACX,MAAO,CACL,MAAO,GACP,MAAO,UAAA,UAIPA,GAAU,EACZ,MAAO,CACL,MAAO,GACP,MAAO,WAAA,EAKb,MAAO,CAAE,MAAO,EAAA,CAClB"}